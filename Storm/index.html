<canvas id="gc" width="800" height="800"></canvas>
<script type="text/javascript" src="dat.gui.min.js"></script>
<script type="text/javascript" src="thunderbolt.js"></script>
<script type="text/javascript" src="wind.js"></script>
<script type="text/javascript" src="rain.js"></script>
<script type="text/javascript" src="tree.js"></script>
<script>

var vars = {
	num_trees: 3,
}

function loop () {
	update();
	draw();
}

function update () {
	tb.update();
	wind.update();
	rain.update();
}

function draw () {
	tb.draw();

	for (var i = 0; i < trees.length; ++i) {
		trees[i].draw();
	}
	rain.draw();
}

window.onload = function () {
	canv = document.getElementById("gc");
	ctx = canv.getContext("2d");

	// User interface
	gui = new dat.GUI();
	general_controls = gui.addFolder("General");
	general_controls.open();

	var x_offset = canv.width / vars.num_trees;
	trees = [];
	for (var i = 0; i < vars.num_trees; ++i) {
		trees.push(new Tree());
		trees[i].generate(random_round(50+i*x_offset,i*x_offset+x_offset-50), random_round(800,900), random_round(50,100));
	}

	tb = new Thunderbolt();
	wind = new Wind();
	rain = new Rain();

	setInterval(loop, 1000/30);
}

function random (min, max, round) {
  	return Math.random() * (max - min + 1) + min;
}

function random_round (min, max, round) {
  	return Math.floor(Math.random() * (max - min + 1)) + min;
}

function module (x, y) {
	return Math.sqrt(square(x) + square(y));
}

function distance (x1, y1, x2, y2) {
	return Math.sqrt(square(x1 - x2) + square(y1 - y2));
}

function square (x) {
	return x*x;
}

</script>